<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.0">Jekyll</generator><link href="/feed.xml" rel="self" type="application/atom+xml" /><link href="/" rel="alternate" type="text/html" /><updated>2021-02-03T14:07:25+09:00</updated><id>/feed.xml</id><title type="html">A workbench of Seokhwan’s</title><subtitle>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
</subtitle><author><name>Seokhwan Kwon</name><email>sychar05@gmail.com</email></author><entry><title type="html">오차 역전파의 계산법 (Back propagation)</title><link href="/deeplearning/2021/02/02/Back-propagation.html" rel="alternate" type="text/html" title="오차 역전파의 계산법 (Back propagation)" /><published>2021-02-02T00:00:00+09:00</published><updated>2021-02-02T00:00:00+09:00</updated><id>/deeplearning/2021/02/02/Back-propagation</id><content type="html" xml:base="/deeplearning/2021/02/02/Back-propagation.html">&lt;p&gt;&lt;img src=&quot;/assets/images/출력층의_오차_업데이트.png&quot; alt=&quot;출력층의_오차_업데이트&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;1-출력층의-오차-업데이트&quot;&gt;1. 출력층의 오차 업데이트&lt;/h2&gt;

\[w_{31} (t + 1) = w_{31}t - \frac{d 오차 y_{out}}{dw_{31}}\]

&lt;h2 id=&quot;2-오차-공식&quot;&gt;2. 오차 공식&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1.&lt;/code&gt;식에서 y&lt;sub&gt;out&lt;/sub&gt;에 대한 값은 아래와 같이 구할 수 있다.
\(오차 y_{out} = 오차y_{o1} + 오차y_{o2}\)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;y&lt;sub&gt;o1&lt;/sub&gt;, y&lt;sub&gt;o2&lt;/sub&gt;는 앞에서 배운 MSE로 나타낸다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;\(y_{o1} = \frac{1}{2}(y_{t1} - y_{o1})^{2}\)
\(y_{o2} = \frac{1}{2}(y_{t2} - y_{o2})^{2}\)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;계산을 통해 나오는 출력값(output : y&lt;sub&gt;o1&lt;/sub&gt;, y&lt;sub&gt;o2&lt;/sub&gt;)이 실제값(target : y&lt;sub&gt;t1&lt;/sub&gt;, y&lt;sub&gt;t2&lt;/sub&gt;)과 같도록 가중치를 조절해야한다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;위 식을 정리하면 아래와 같다.&lt;/p&gt;

\[오차dy_{out} = \frac{1}{2}(y_{t1} - y_{o1})^{2} + \frac{1}{2}(y_{t2} - y_{o2})^{2}\]

&lt;h2 id=&quot;3-체인룰&quot;&gt;3. 체인룰&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;2.&lt;/code&gt;에서 구한 y&lt;sub&gt;out&lt;/sub&gt;을 w&lt;sub&gt;31&lt;/sub&gt;로 편미분하기 위해서는 체인룰을 알아야한다.&lt;/p&gt;

&lt;p&gt;체인룰을 알려면 합성함수의 미분을 알아야한다.
합성함수의 미분공식은 아래와 같다.&lt;/p&gt;

\[\left \{ f(g(x)) \right \}' = f'(g(x))g'(x)\]

\[\frac{df}{dx} = \frac{df}{dg} \cdot \frac{dg}{dx}\]

&lt;p&gt;이제 기초지식을 쌓았다. 그러면 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1.&lt;/code&gt;에서 구해야하는 dy&lt;sub&gt;out&lt;/sub&gt;/dw&lt;sub&gt;31&lt;/sub&gt;를 구하는 방법은 아래와 같다.&lt;/p&gt;

\[\frac{d오차y_{out}}{dw_{31}} = \frac{d오차y_{out}}{dy_{o1}} \cdot \frac{dy_{o1}}{d가중합_{3}} \cdot \frac{d가중합_{3}}{dw_{31}}\]

&lt;h2 id=&quot;4-체인룰-계산하기&quot;&gt;4. 체인룰 계산하기&lt;/h2&gt;
&lt;p&gt;\(\frac{d오차y_{out}}{dw_{31}} = \frac{d오차y_{out}}{dy_{o1}} \cdot \frac{dy_{o1}}{d가중합_{3}} \cdot \frac{d가중합_{3}}{dw_{31}}\)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;=&lt;/code&gt; 다음에 나오는 식을 각각  (1), (2), (3)이라고 한다면, 풀이하면 아래와 같다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;1&quot;&gt;(1)&lt;/h4&gt;
&lt;p&gt;\(\frac{d오차y_{out}}{dy_{o1}} = \left \{오차y_{o1} + 오차y_{o2}  \right \}'\)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;이때, y&lt;sub&gt;o1&lt;/sub&gt;에 대한 편미분이기 때문에  y&lt;sub&gt;o2&lt;/sub&gt;는 미분하면 0이 되기때문에 무시하고 연산할 수 있다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;\(= \left \{ \frac{1}{2}(y_{t1} - y_{o1})^{2} \right\}'\)
\(= (y_{t1} - y_{o1}) \cdot (-1)\)
\(\therefore \frac{d오차y_{out}}{dy_{o1}} = (y_{o1} - y_{t1})\)&lt;/p&gt;

&lt;h4 id=&quot;2&quot;&gt;(2)&lt;/h4&gt;

&lt;p&gt;\(\frac{dy_{o1}}{d가중합_{3}}\)
위는 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;활성화 함수의 미분&lt;/code&gt;이다. 맨위의 flowchart를 확인해보고 이해해보자.&lt;/p&gt;

&lt;p&gt;우리는 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;활성화 함수&lt;/code&gt;를 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;시그노이드&lt;/code&gt;로 예를 들고 풀어보겠다.&lt;/p&gt;

\[\frac{dy_{o1}}{d가중합_{3}} = y_{o1} \cdot (1 - y_{o1})\]

&lt;p&gt;시그노이드의 미분의 증명은 아래와 같다.&lt;/p&gt;

&lt;p&gt;\(\frac{d}{dx}(\frac{1}{1 + e^{-x}}) = \frac{d}{dx}(1 + e^{-x})^{-1}\)
\(= -(1 + e^{-x})^{-2} \cdot (-e^{-x})\)
\(= \frac{e^{-x}}{(1 + e^{-x})^{2}}\)
\(= \frac{1 + e^{-x} - 1}{(1 + e^{-x})^{2}}\)
\(= \frac{1}{1 + e^{-x}} - \frac{1}{(1 + e^{-x})^{2}}\)
\(= \frac{1}{1 + e^{-x}} (1 - \frac{1}{1 + e^{-x}})\)
\((\because \sigma = \frac{1}{1 + e^{-x}})\)
\(\therefore \frac{d}{dx}  \sigma (x) = \sigma (x) (1 - \sigma (x) )\)&lt;/p&gt;

&lt;h4 id=&quot;3&quot;&gt;(3)&lt;/h4&gt;

\[\frac{dy_{o1}}{d가중합_{3}}\]

&lt;p&gt;위 식을 구하기 위해서는 가중합&lt;sub&gt;3&lt;/sub&gt;을 구해야 한다.&lt;/p&gt;

\[가중합_{3} = w_{31}y_{h1} + w_{32}y_{h2} + 1(bias)\]

&lt;blockquote&gt;
  &lt;p&gt;신경망에서는 bias를 항상 1로 설정한다.
why? bias는 그래프를 좌우로 움직이는 역할이다.
시그노이드에서 bias가 1일 때 가장 안정된 예측을 한다.
따라서 따로 계산할 필요 없이 1로 설정해준다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;flowchart를 보면, n1, n2 노드로 부터 전달된 y&lt;sub&gt;h&lt;/sub&gt;값과 w&lt;sub&gt;(2)&lt;/sub&gt;값을 통해 만든다.&lt;/p&gt;

\[\frac{dy_{o1}}{d가중합_{3}} = y_{h1}\]

&lt;h4 id=&quot;결론&quot;&gt;(결론)&lt;/h4&gt;

\[\frac{d오차y_{out}}{dw_{31}} = \frac{d오차y_{out}}{dy_{o1}} \cdot \frac{dy_{o1}}{d가중합_{3}} \cdot \frac{d가중합_{3}}{dw_{31}}\]

\[= (y_{o1} - y_{t1}) \cdot y_{o1}(1 - y_{o1}) \cdot y_{h1}\]

&lt;h2 id=&quot;5-가중치-업데이트하기&quot;&gt;5. 가중치 업데이트하기&lt;/h2&gt;

\[w_{31} (t + 1) = w_{31}t - \frac{d 오차 y_{out}}{dw_{31}}\]

\[= w_{31}t - (y_{o1} - y_{t1}) \cdot y_{o1}(1 - y_{o1}) \cdot y_{h1}\]

\[(\because \delta = (y_{o1} - y_{t1}) \cdot y_{o1}(1 - y_{o1}))\]

&lt;blockquote&gt;
  &lt;p&gt;위 식에서 delta 부분을 잘 기억해야한다.
n3(node)의 delta식이라고 한다.&lt;/p&gt;
&lt;/blockquote&gt;

\[= w_{31}t - \delta \cdot y_{h1}\]

&lt;h2 id=&quot;6-은닉층의-오차-업데이트&quot;&gt;6. 은닉층의 오차 업데이트&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/은닉층의_오차_업데이트.png&quot; alt=&quot;은닉층의_오차_업데이트&quot; /&gt;&lt;/p&gt;

\[w_{11}(t + 1) = w_{11}t - \frac{d오차 Y_{out}}{dw_{11}}\]

&lt;blockquote&gt;
  &lt;p&gt;d 오차 y&lt;sub&gt;h&lt;/sub&gt;가 아닌점에 주목!&lt;/p&gt;

  &lt;p&gt;why? y&lt;sub&gt;h&lt;/sub&gt;는 은닉층 안에 위치하므로
겉으로 들어나지 않기때문에 사용할 수 없다.&lt;/p&gt;
&lt;/blockquote&gt;

\[\frac{d오차y_{out}}{dw_{11}} = \frac{d오차y_{out}}{dy_{h1}} \cdot \frac{dy_{h1}}{d가중합_{1}} \cdot \frac{d가중합_{1}}{dw_{11}}\]

&lt;blockquote&gt;
  &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;=&lt;/code&gt; 다음에 나오는 식을 각각  (1), (2), (3)이라고 한다면,
(2), (3)은 앞에 출력층의 오차 업데이트와 동일한 방법으로 진행하면 된다.
다만, (1)은 풀이방식이 조금 다르다 왜냐하면 위 flowchart에서 보여지는 것처럼 은닉층이기 때문에 중간의 y&lt;sub&gt;h1&lt;/sub&gt;을 바로 알 수 없다. 따라서 y&lt;sub&gt;out&lt;/sub&gt;의 값에서 유도를 해야하기 때문이다.&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>[&quot;Seokhwan Kwon&quot;]</name></author><category term="deeplearning" /><summary type="html"></summary></entry><entry><title type="html">최소 제곱법 (Method of least squares)</title><link href="/math/2021/01/30/Method-of-least-squares.html" rel="alternate" type="text/html" title="최소 제곱법 (Method of least squares)" /><published>2021-01-30T00:00:00+09:00</published><updated>2021-01-30T00:00:00+09:00</updated><id>/math/2021/01/30/Method-of-least-squares</id><content type="html" xml:base="/math/2021/01/30/Method-of-least-squares.html">&lt;blockquote&gt;
  &lt;p&gt;입력 변수 \((x)\)가 한 개일 때 사용합니다. (여러 개의 입력을 처리하지 못한다.)
여러개의 \((x, y)\)가 주어질때, \(y = ax + b\)를 구하는 방법입니다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ol&gt;
  &lt;li&gt;x, y 입력&lt;/li&gt;
  &lt;li&gt;x, y의 평균 구하기&lt;/li&gt;
  &lt;li&gt;a, b 구하기&lt;/li&gt;
  &lt;li&gt;y = ax + b 출력&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;br /&gt;
\(a = \frac{\sum (x - \bar{x})(y - \bar{y})}{\sum(x - \bar{x})^{2}}\)
\(b = \bar{y} - (\bar{x} \times a )\)&lt;/p&gt;

&lt;h2 id=&quot;ex-01_least_square_methodpy&quot;&gt;Ex) 01_Least_Square_Method.py&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;공부한 시간&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;2시간&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;4시간&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;6시간&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;8시간&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;성적&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;81점&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;93점&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;91점&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;97점&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;\(x = \{ 2, 4, 6, 8 \}\)
\(y = \{ 81, 93, 91, 97 \}\)&lt;/p&gt;

&lt;p&gt;\(\bar{x} = \frac{2 + 4 + 6 + 8}{4} = 5\)
\(\bar{y} = \frac{81 + 93 + 91 + 97}{4} = 90.5\)&lt;/p&gt;

&lt;p&gt;\(a = \frac{\sum (x - \bar{x})(y - \bar{y})}{\sum(x - \bar{x})^{2}}\)
\(= \frac{(2 - 5)(81 - 90.5) + (4 - 5)(93 - 90.5) + \cdots + (8 - 5)(97 - 90.5)}{(2 - 5)^{2} + (4 - 5)^{2} + \cdots + (8 - 5)^{2}  }\)
\(= \frac{46}{20} = 2.3\)
 
\(b = \bar{y} - (\bar{x} \times a )\)
\(= 90.5 - (2.3 \times 5 )\)
\(= 79\)&lt;/p&gt;

\[y = 2.3x + 79\]

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;공부한 시간&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;2시간&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;4시간&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;6시간&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;8시간&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;성적&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;81점&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;93점&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;91점&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;97점&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;예측 값&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;83.6&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;88.2&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;92.8&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;97.4&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;</content><author><name>[&quot;Seokhwan Kwon&quot;]</name></author><category term="math" /><summary type="html">입력 변수 \((x)\)가 한 개일 때 사용합니다. (여러 개의 입력을 처리하지 못한다.) 여러개의 \((x, y)\)가 주어질때, \(y = ax + b\)를 구하는 방법입니다.</summary></entry></feed>